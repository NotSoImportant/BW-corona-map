<ux-dashboard #dashboard
              class="customizable-dashboard"
              [class.dashboard-grabbing]="dashboard.isGrabbing"
              [options]="dashboardOptions">

  <ux-dashboard-widget id="analytics-1-widget"
                       name="Usage Analytics"
                       [colSpan]="4"
                       [rowSpan]="mapRowSpan"
                       [resizable]="true">

    <div class="widget-content"
         [class.widget-grabbing]="usageHandle.isGrabbing">

      <h3 class="widget-title">Coronavirus Map in Baden WÃ¼rttemberg</h3>
      <p>Click desired area on the map to see the infection rate and history.</p>

      <button class="widget-grab-handle"
              uxDashboardGrabHandle
              uxDashboardWidgetDragHandle
              #usageHandle="ux-dashboard-grab-handle">
        <ux-icon name="pan"></ux-icon>
      </button>

      <app-bw-svg-map
        (regionClick)="onRegionClick($event)"
        [regionData]="regionData$ | async">]
      </app-bw-svg-map>

    </div>
  </ux-dashboard-widget>

  <ux-dashboard-widget id="history-widget"
                       name="History"
                       [colSpan]="3"
                       [rowSpan]="detailRowSpan">
    <div class="widget-content"
         [class.widget-grabbing]="historyHandle.isGrabbing">

      <h3 class="widget-title">History Graph
        <span *ngIf="!selectedRegion || showAllBWArea">Total</span>
        <span *ngIf="selectedRegion && !showAllBWArea">{{selectedRegion.data.name}}</span>
      </h3>

      <div class="sub-info">
        <p *ngIf="todaysCases">Total cases until today: <span > {{todaysCases}} </span></p>
        <div class="toggle-all-bw-area">
          Show total
          <label class="switch">
            <input type="checkbox"
                   [(ngModel)]="showAllBWArea"
                   [ngModelOptions]="{standalone: true}"
                   (change)="generateChartData(null)">
            <span class="slider round"></span>
          </label>
        </div>
      </div>

      <button class="widget-grab-handle"
              uxDashboardGrabHandle
              uxDashboardWidgetDragHandle
              #historyHandle="ux-dashboard-grab-handle">
        <ux-icon name="pan"></ux-icon>
      </button>

      <div class="widget-chart">
        <canvas aria-label="Bar chart showing file type totals"
                baseChart
                [datasets]="barChartData"
                [labels]="barChartLabels"
                [options]="barChartOptions"
                [legend]="barChartLegend"
                [colors]="barChartColors"
                chartType="bar">

          <table>
            <thead>
            <tr>
              <th>File Type</th>
              <th>Number of Files</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let label of barChartLabels; let idx = index">
              <td>{{label}}</td>
              <td>{{barChartData[0].data[idx]}}</td>
            </tr>
            </tbody>
          </table>

        </canvas>
      </div>

    </div>
  </ux-dashboard-widget>

  <ux-dashboard-widget id="info-widget"
                       name="Info"
                       [colSpan]="3"
                       [rowSpan]="detailRowSpan">
    <div class="widget-content prominent"
         [class.widget-grabbing]="infoHandle.isGrabbing">

      <h3 class="widget-title">Further Info
        <span *ngIf="!selectedRegion || showAllBWArea">Total</span>
        <span *ngIf="selectedRegion && !showAllBWArea">{{selectedRegion.data.name}}</span>
      </h3>

      <button class="widget-grab-handle"
              uxDashboardGrabHandle
              uxDashboardWidgetDragHandle
              #infoHandle="ux-dashboard-grab-handle">
        <ux-icon name="pan"></ux-icon>
      </button>

      <p class="info-title">Today: {{todaysDate}}</p>
      <ng-container>
        <p class="info-value m-t text-black">
          #Cases today: <b>{{todaysCases}}</b>
        </p>
        <p class="info-value m-t text-black">
          #Recoveries: <i>{{getNumberOfRecoveries()}}</i>
        </p>
        <p>
          Number of recoveries is detected by calculating decreasing number of cases per day per region. That means:
        </p>
        <ol>
          <li>Number of occurrences where a patient is declared that s(he) has been recovered, thus is not included the the graph anymore.</li>
          <li>However this patient <u><i>could</i></u> be contracted the virus again.</li>
        </ol>
        <i>So it does not represents exactly number of poeple that recovered, but to be precise number of cases where patient is declared to be recovered.</i>
      </ng-container>

      <hr>
      <small>Stay tuned more info is coming.. <i>*not more cases hopefully</i>ðŸ˜‡</small>

      <hr>
      <p class="info-value m-t text-black">
        <i>Display a map of coronavirus infections in Baden-WÃ¼rttemberg area, including history graph per area.<br>
          Data is taken from <a href="https://sozialministerium.baden-wuerttemberg.de/" target="_blank">https://sozialministerium.baden-wuerttemberg.de/</a>and updated daily.</i>
        <br>
      </p>

      <div>
        <img src="assets/github-icon.png" width="50px" height="40px"> <a href="https://github.com/taufanardi/BW-corona-map" target="_blank">Fork this project</a>
      </div>

    </div>
  </ux-dashboard-widget>

</ux-dashboard>
